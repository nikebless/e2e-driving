#!/bin/bash

#SBATCH --job-name="Extract driving data from thesis evaluation drives"
#SBATCH --time=23:59:00
#SBATCH --cpus-per-task=1
#SBATCH --partition=main
#SBATCH --mem=40G
#SBATCH --array=0-32

BAGS=(
    '2022-08-31-14-52-25_elva_classifier_512_forward.bag' \
    '2022-08-31-15-18-55_elva_classifier_512_forward_continued.bag' \
    '2022-08-31-15-26-05_elva_classifier_512_back.bag' \
    '2022-08-31-15-37-37_elva_ebm_512_front.bag' \
    '2022-08-31-15-48-15_elva_ebm_512_back.bag' \
    '2022-08-31-16-00-20_elva_classifier_256_front.bag' \
    '2022-08-31-16-11-28_elva_classifier_256_back.bag' \
    '2022-08-31-16-29-08_elva_ebm_256_front.bag' \
    '2022-08-31-16-42-01_elva_ebm_256_back.bag' \
    '2022-08-31-16-53-38_elva_classifier_128_front.bag' \
    '2022-08-31-17-04-28_elva_classifier_128_back.bag' \
    '2022-08-31-17-16-19_elva_ebm_128_front.bag' \
    '2022-08-31-17-26-53_elva_ebm_128_back.bag' \
    '2022-08-31-17-39-38_elva_classifier_512_front_rep2.bag' \
    '2022-08-31-17-50-13_elva_ebm_512_back_rep2.bag' \
    '2022-09-02-09-54-31_elva_mae_s1_rep1.bag' \
    '2022-09-02-10-20-29_elva_mae_s1_rep2.bag' \
    '2022-09-02-10-42-07_elva_mae_s1_rep3.bag' \
    '2022-09-02-11-04-39_elva_ebm_512_s1_rep1.bag' \
    '2022-09-02-11-27-02_elva_ebm_512_s1_rep2.bag' \
    '2022-09-02-11-48-55_elva_ebm_512_s1_rep3.bag' \
    '2022-09-08-10-13-30_ebm-512-s1.bag' \
    '2022-09-08-10-38-33_ebm_512_s2.bag' \
    '2022-09-08-11-01-21_ebm-512-s3.bag' \
    '2022-09-08-11-26-29_mae-s1.bag' \
    '2022-09-08-11-49-08_mae-s2.bag' \
    '2022-09-08-12-13-25_mae-s3.bag' \
    '2022-09-09-10-04-05-mdn-3-s2.bag' \
    '2022-09-09-10-27-50-mdn-5-s2.bag' \
    '2022-09-09-10-51-33-mdn-1-s1.bag' \
    '2022-09-09-11-00-03-mdn-5-s1.bag' \
    '2022-09-09-11-23-11-mdn-3-s3.bag' \
    '2022-09-09-11-47-04.bag' \
)


./extract_rocket.sh ${BAGS[$SLURM_ARRAY_TASK_ID]}  /gpfs/space/projects/Bolt/end-to-end/drives-ebm-paper
python ./image_extractor.py --bag-file=/gpfs/space/projects/Bolt/bagfiles/$1 --extract-dir=$2
